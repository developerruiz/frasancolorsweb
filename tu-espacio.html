<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <!-- META -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content=" Francisco Santos Arreola empresario mexicano, hijo del primer presidente panista del municipio de Cuautitlán, miembro del Consejo Empresarial del Instituto
    Tecnológico y de Estudios Superiores de Monterrey, genero empleos directos para más de 150 familias del Valle de México y en McAllen Estados Unidos." />
    <meta name="keywords"
        content="emprendedor mexicanos exitosos apasionado animado constructor empresario eficaz familiar innovador oportunista personalidad moral futuro generosidad honestidad humano lealtad simple poder ciudadano soñador " />
    <meta name="Frasan Group" content="Frasan Group" />
    <meta name="robots" content="index" />
    <meta http-equiv="cache-control" content="no-cache" />

    <!-- FUENTE -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;700;900&display=swap" rel="stylesheet">

    <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous"> -->

    <title>FrasanColors</title>

    <!-- STYLES -->
    <link rel="stylesheet" href="css/slide.css">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/menuslide.css">
    <link rel="stylesheet" href="css/magic.css">

    <!-- ICONS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

    <!-- JQUERY -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.1.1/assets/owl.carousel.min.css'>
    <script src="https://unpkg.com/magic-wand-tool@latest/dist/magic-wand.min.js"></script>
</head>

<body>
<!-- 
    <div class="icon-pantone">
        <a href="pantone.html">
            <img src="img/pantone.png" alt="">
        </a>
    </div> -->

<!-- 
    <div class="loading">
        <div class="logoload">
            <img src="img/frasan-b.png" alt="">
        </div>
    </div> -->

    <!-- HEADER-->
    <header>
        <nav class="nav_bar" id="menu-desktop">
            <div class="logo">
                <a href="index.html">
                    <img src="img/frasancolors.png" alt="">
                </a>
            </div>
            <div class="lista-menu">
                <ul class="opciones-menu1">
                    <a href="index.html">
                        <li>Color</li>
                    </a>
                    <li>Productos <i class="fas fa-caret-down"></i>
                        <div class="mega-menu">

                            <ul class="opciones-menu">

                                <h3 class="op">Categorías</h3>

                                <li class="op vinil">Vinílicas <i class="fas fa-caret-right"></i>
                                    <div class="prod-vinilicas">
                                        <ul class="submenu-op-prod">
                                            <h3 class="op">Cubetas</h3>

                                            <a href="cubeta-suprema.html">
                                                <li class="op-submenu">
                                                    Suprema
                                                    <div class="img-prod">
                                                        <img src="img/cubeta_suprema_19.png" alt="">
                                                    </div>
                                                </li>
                                            </a>

                                            <a href="cubeta-suprema-premium.html">
                                                <li class="op-submenu">
                                                    Suprema Premium
                                                    <div class="img-prod">
                                                        <img src="img/cubeta_supremapremium19.png" alt="">
                                                    </div>
                                                </li>
                                            </a>
                                            <a href="cubeta-estelar.html">
                                                <li class="op-submenu">
                                                    Estelar
                                                    <div class="img-prod">
                                                        <img src="img/cubeta_estelar19.png" alt="">
                                                    </div>
                                                </li>
                                            </a>
                                            <a href="cubeta-supervision.html">
                                                <li class="op-submenu">
                                                    Supervisión
                                                    <div class="img-prod">
                                                        <img src="img/cubeta_supervision19.png" alt="">
                                                    </div>
                                                </li>
                                            </a>
                                        </ul>
                                    </div>
                                </li>
                                <li class="op esmalte">Esmaltes <i class="fas fa-caret-right"></i>
                                    <div class="prod-esmalte">

                                        <ul class="submenu-op-prod">
                                            <h3 class="op">Cubetas</h3>

                                            <a href="cubeta-supremo.html">
                                                <li class="op-submenu">
                                                    Supremo
                                                    <div class="img-prod">
                                                        <img src="img/cubeta_supremo19.png" alt="">
                                                    </div>
                                                </li>
                                            </a>

                                            <a href="cubeta-supremowb.html">
                                                <li class="op-submenu">
                                                    Supremo WB
                                                    <div class="img-prod">
                                                        <img src="img/cubeta_supremowb19.png" alt="">
                                                    </div>
                                                </li>
                                            </a>
                                            <a href="cubetavial.html">
                                                <li class="op-submenu">
                                                    Trafico
                                                    <div class="img-prod">
                                                        <img src="img/cubeta_trafico19.png" alt="">
                                                    </div>
                                                </li>
                                            </a>
                                        </ul>

                                    </div>
                                </li>
                                <li class="op impermeble">Impermeabilizantes<i class="fas fa-caret-right"></i>
                                    <div class="prod-impermeble">

                                        <ul class="submenu-op-prod">
                                            <h3 class="op">Cubetas</h3>

                                            <a href="cubeta-elastocryl.html">
                                                <li class="op-submenu">
                                                    Elastocryl
                                                    <div class="img-prod">
                                                        <img src="img/cubeta_elastocryl_fs5.png" alt="">
                                                    </div>
                                                </li>
                                            </a>

                                        </ul>

                                    </div>
                                </li>
                                <a href="productos.html">
                                    <li class="op">Todos

                                    </li>
                                </a>
                                <li class="op text-disabled">Complementos <i class="fas fa-caret-right"></i>

                                </li>
                            </ul>

                            <!-- <div class="columna img">
                                <img src="img/cubeta_estelar19.png" alt="">
                            </div> -->

                        </div>
                    </li>
                    <li> Inspiración <i class="fas fa-caret-down"></i>
                        <div class="mega-menu">

                            <ul class="opciones-menu">

                                <h3 class="op">Inspirate</h3>

                                <li class="op espacios">Espacios <i class="fas fa-caret-right"></i>

                                    <div class="opciones-espacios">

                                        <ul class="op-espacio">
                                            <a href="fachada.html" class="vista-espacio">
                                                <img src="img/fachada-menu.jpg" alt="">
                                                <p> Fachadas</p>
                                            </a>
                                            <a href="sala.html" class="vista-espacio">
                                                <img src="img/sala-menu.jpg" alt="">
                                                <p>Sala</p>
                                            </a>
                                            <a href="comedor.html" class="vista-espacio">
                                                <img src="img/comedor-menu.jpg" alt="">
                                                <p>Comedor</p>
                                            </a>
                                            <a href="cocina.html" class="vista-espacio">
                                                <img src="img/cocina-menu.jpg" alt="">
                                                <p>Cocina</p>
                                            </a>
                                            <a href="habitacion.html" class="vista-espacio">
                                                <img src="img/habitacion-menu.jpg" alt="">
                                                <p>Recamara</p>
                                            </a>
                                            <a href="bano.html" class="vista-espacio">
                                                <img src="img/baño-menu.jpg" alt="">
                                                <p>Baños</p>
                                            </a>
                                        </ul>
                                    </div>

                                </li>
                                <li class="op espacios">Color en tu vida <i class="fas fa-caret-right"></i>


                                    <div class="opciones-espacios">

                                        <ul class="op-espacio">
                                            <a href="pantone.html" class="vista-espacio">
                                                <img src="img/paletacolores.jpg" alt="">
                                                <p> Paleta de colores</p>
                                            </a>
                                            <a class="vista-espacio">
                                                <img src="img/espacio.jpg" alt="">
                                                <p>Pinta tu espacio</p>
                                            </a>
                                            <a class="vista-espacio" style="opacity: .3;">
                                                <img src="img/tendencia.jpg" alt="">
                                                <p class="text-disable">Tendencia</p>
                                            </a>
                                            <a href="combina.html" class="vista-espacio">
                                                <img src="img/colorvida.jpg" alt="">
                                                <p>Color en tu vida</p>
                                            </a>

                                        </ul>
                                    </div>
                                </li>
                            </ul>

                        </div>
                    </li>
                    <li> Historias de éxito</li>
                    <a href="carrito.html">
                        <li>Carrito</li>
                    </a>

                </ul>
            </div>
            <div class="others ">
                <ul class="d-flex justify-content-around">
                    <a href="carrito.html">
                        <li><i class="fas fa-shopping-cart"></i></li>
                    </a>
                    <li>
                        <i class="fab fa-whatsapp"></i>
                    </li>
                    <li></li>
                    <li></li>
                </ul>
            </div>
            <div class="burger-menu" id="burger_menu">
                <a href="#menu-movil">
                    <i class="fas fa-bars"></i>
                </a>
            </div>
        </nav>

        <!-- MENU MOVIL -->
        <div class="menu-movil" id="menu_movil">
            <div class="lista-menu-movil">
                <ul>
                    <li>
                        <div>
                            <a href="index.html">
                                <div>
                                    Color
                                </div>
                            </a>
                        </div>
                    </li>
                    <li>
                        <div>
                            Productos <i class="fas fa-caret-down"></i>
                        </div>

                        <div class="submenu-movil">
                            <ul>
                                <li>
                                    <div>
                                        Vinílicas <i class="fas fa-caret-down"></i>
                                    </div>
                                    <div class="subsub-menu">
                                        <ul>
                                            <a href="cubeta-suprema.html">
                                                <li>Suprema</li>
                                            </a>
                                            <a href="cubeta-suprema-premium.html">
                                                <li>Suprema Premium</li>
                                            </a>
                                            <a href="cubeta-estelar.html">
                                                <li>Estelar</li>
                                            </a>
                                            <a href="cubeta-supervision.html">
                                                <li>Supervisón</li>
                                            </a>
                                        </ul>
                                    </div>
                                </li>
                                <li>
                                    <div>
                                        Esmaltes <i class="fas fa-caret-down"></i>
                                    </div>
                                    <div class="subsub-menu">
                                        <ul>
                                            <a href="cubeta-supremo.html">
                                                <li>Supremo</li>
                                            </a>
                                            <a href="cubeta-supremowb.html">
                                                <li>Suprema WB</li>
                                            </a>
                                            <a href="cubetavial.html">
                                                <li>Trafico</li>
                                            </a>

                                        </ul>
                                    </div>
                                </li>
                                <li>
                                    <div>
                                        Impermeabilizantes<i class="fas fa-caret-down"></i>
                                    </div>
                                    <div class="subsub-menu">
                                        <ul>
                                            <a href="cubeta-elastocryl.html">
                                                <li>Elastocryl</li>
                                            </a>
                                        </ul>
                                    </div>
                                </li>
                                <li>Complementos</li>
                                <a href="productos.html">
                                    <li>Todos</li>
                                </a>

                            </ul>
                        </div>
                    </li>
                    <!-- INSPIRACION -->
                    <li>
                        <div>
                            Inspiración <i class="fas fa-caret-down"></i>
                        </div>

                        <div class="submenu-movil">
                            <ul>
                                <li>
                                    <div>
                                        Espacios <i class="fas fa-caret-down"></i>
                                    </div>
                                    <div class="subsub-menu">
                                        <ul>
                                            <a href="fachada.html">
                                                <li>Fachada</li>
                                            </a>
                                            <a href="sala.html">
                                                <li>Sala</li>
                                            </a>
                                            <a href="comedor.html">
                                                <li>Comedor</li>
                                            </a>
                                            <a href="cocina.html">
                                                <li>Cocina</li>
                                            </a>
                                            <a href="habitacion.html">
                                                <li>Recamara</li>
                                            </a>
                                            <a href="bano.html">
                                                <li>Baños</li>
                                            </a>
                                        </ul>
                                    </div>
                                </li>
                                <li>
                                    <div>
                                        Color en tu vida <i class="fas fa-caret-down"></i>
                                    </div>
                                    <div class="subsub-menu">
                                        <ul>
                                            <a href="pantone.html">
                                                <li>Paleta de Colores</li>
                                            </a>
                                            <a href="cubeta-supremowb.html">
                                                <li class="text-disabled">Pinta tu espacio</li>
                                            </a>
                                            <a href="#">
                                                <li class="text-disabled">Tendencia</li>
                                            </a>
                                            <a href="combina.html">
                                                <li>Colores en tu vida</li>
                                            </a>
                                        </ul>
                                    </div>
                                </li>

                            </ul>
                        </div>
                    </li>
                    <!-- CARRITO -->
                    <li>
                        <div>
                            <a href="carrito.html">
                                <div>
                                    Carrito
                                </div>
                            </a>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
        <!-- MENU MOVIL -->
        <div class="sub-menu">
            <ul>
                <!-- <li>sdfg</li>
                <li>sdfg</li>
                <li>sdfg</li>
                <li>sdfg</li> -->
            </ul>
        </div>

        <div class="line-gradient"></div>
    </header>
    <!-- FIN DE HEADER -->
    <main>

     <div class="contenedor">
            <div style="overflow: auto">
                <div class="button" onclick="uploadClick()">Upload image and click on it</div>
                <div class="button" onclick="trace()">Create polygons by current selection</div>
                <div class="button" onclick="paint('000080', 0.35)">Paint the selection</div>
                <input id="file-upload" type="file" accept="image/*" onchange="imgChange(this)" />
            </div>
            <div style="overflow: auto">
                <div style="float: left; margin-right: 10px;">Blur radius: </div>
                <input id="blurRadius" type="text" onchange="onRadiusChange.apply(this, arguments)" style="float: left; width: 20px; margin-right: 10px;"/>
                <div id="threshold"></div>
            </div>
            <div>(hold left mouse button and move to change the color threshold)</div>
            <div>(hold the CTRL key to add selection)</div>
            <div class='wrapper'>
                <div class='content'>
                    <img id="test-picture" class="picture" />
                    <canvas class="canvas" id="resultCanvas" onmouseup="onMouseUp.apply(this, arguments)" onmousedown="onMouseDown.apply(this, arguments)" onmousemove="onMouseMove.apply(this, arguments)"></canvas>
                </div>
            </div>
         
         
         
     </div>
    </main>

    <footer>
        <div class="row">
            <div class="columna">
                <h3>Frasan Colors</h3>

                <p>Más que un color, haz tu espacio único</p>
                <hr>
                <div class="redes">
                    <ul>
                        <li>
                            <a href="#">
                                <i class="fab fa-facebook"></i>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <i class="fab fa-instagram"></i>

                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <i class="fab fa-linkedin"></i>

                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <i class="fab fa-twitter"></i>

                            </a>
                        </li>
                    </ul>

                </div>
            </div>
            <div class="columna">
                <h3>Empresa</h3>
                <ul>
                          <a href="quienessomos.html">
                        <li>Quíenes somos</li>
                    </a>
                    <a href="certificacion.html">
                        <li>Certificaciones</li>
                    </a>
                    <a href="contacto.html">
                        <li>Contacto</li>
                    </a>
                </ul>
            </div>
            <div class="columna">
                <h3>Herramientas</h3>
                <ul>
                    <a href="pantone.html">
                        <li>Paleta de colores</li>
                    </a>
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="columna">
                Destajistas 14, Industrial Xhala, 54750 Cuautitlán Izcalli, Estado de México.
            </div>
            <div class="columna">
                <a href="mailto:contacto@frasancolors.mx">contacto@frasancolors.mx</a>
            </div>
            <div class="columna">
                <a href="tel:+525573142719">(+52)55 7314 2719</a>
            </div>
        </div>
        <div class="row">
            <div class="columna">
                Aviso de Privacidad
            </div>
            <div class="columna">
                Terminos y condiciones
            </div>
        </div>
        <div class="row">
            <div class="columna">
                <p>&copy; 2021 Fransan Colors | una empresa de Frasan Group</p>
            </div>
        </div>

    </footer>

    <script src="main.js"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.2/jquery.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.1.1/owl.carousel.min.js'></script>
    <script src="script.js"></script>
    <script src="parallax.js"></script>
    <script src="pintar.js"></script>
    <script src="loading.js"></script>
    <script src="menuMovil.js"></script>
    <script src="menuTop.js"></script>
    <script>
        window.onload = function() {
    colorThreshold = 15;
    blurRadius = 5;
    simplifyTolerant = 0;
    simplifyCount = 30;
    hatchLength = 4;
    hatchOffset = 0;

    imageInfo = null;
    cacheInd = null;
    mask = null;
    oldMask = null;
    downPoint = null;
    allowDraw = false;
    addMode = false;
    currentThreshold = colorThreshold;
    
    document.onkeydown = onKeyDown;
    document.onkeyup = onKeyUp;
    
    showThreshold();
    document.getElementById("blurRadius").value = blurRadius;
    setInterval(function () { hatchTick(); }, 300);
}
function uploadClick() {
    document.getElementById("file-upload").click();
}
function onRadiusChange(e) {
    blurRadius = e.target.value;
}
function imgChange (inp) {
    if (inp.files && inp.files[0]) {
        var reader = new FileReader();
        reader.onload = function (e) {
            var img = document.getElementById("test-picture");
            img.setAttribute('src', e.target.result);
            img.onload = function() {
                window.initCanvas(img);
            };
        }
        reader.readAsDataURL(inp.files[0]);
    }
}
function initCanvas(img) {
    var cvs = document.getElementById("resultCanvas");
    cvs.width = img.width;
    cvs.height = img.height;
    imageInfo = {
        width: img.width,
        height: img.height,
        context: cvs.getContext("2d")
    };
    mask = null;
    
    var tempCtx = document.createElement("canvas").getContext("2d");
    tempCtx.canvas.width = imageInfo.width;
    tempCtx.canvas.height = imageInfo.height;
    tempCtx.drawImage(img, 0, 0);
    imageInfo.data = tempCtx.getImageData(0, 0, imageInfo.width, imageInfo.height);
}
function getMousePosition(e) {
    var p = $(e.target).offset(),
        x = Math.round((e.clientX || e.pageX) - p.left),
        y = Math.round((e.clientY || e.pageY) - p.top);
    return { x: x, y: y };
}
function onMouseDown(e) {
    if (e.button == 0) {
        allowDraw = true;
        addMode = e.ctrlKey;
        downPoint = getMousePosition(e);
        drawMask(downPoint.x, downPoint.y);
    } else { 
    		allowDraw = false;
        addMode = false;
        oldMask = null;
    }
}
function onMouseMove(e) {
    if (allowDraw) {
        var p = getMousePosition(e);
        if (p.x != downPoint.x || p.y != downPoint.y) {
            var dx = p.x - downPoint.x,
                dy = p.y - downPoint.y,
                len = Math.sqrt(dx * dx + dy * dy),
                adx = Math.abs(dx),
                ady = Math.abs(dy),
                sign = adx > ady ? dx / adx : dy / ady;
            sign = sign < 0 ? sign / 5 : sign / 3;
            var thres = Math.min(Math.max(colorThreshold + Math.floor(sign * len), 1), 255);
            //var thres = Math.min(colorThreshold + Math.floor(len / 3), 255);
            if (thres != currentThreshold) {
                currentThreshold = thres;
                drawMask(downPoint.x, downPoint.y);
            }
        }
    }
}
function onMouseUp(e) {
    allowDraw = false;
    addMode = false;
    oldMask = null;
    currentThreshold = colorThreshold;
}
function onKeyDown(e) {
	if (e.keyCode == 17) document.getElementById("resultCanvas").classList.add("add-mode");
}
function onKeyUp(e) {
	if (e.keyCode == 17) document.getElementById("resultCanvas").classList.remove("add-mode");
}
function showThreshold() {
    document.getElementById("threshold").innerHTML = "Threshold: " + currentThreshold;
}
function drawMask(x, y) {
    if (!imageInfo) return;
    
    showThreshold();
    
    var image = {
        data: imageInfo.data.data,
        width: imageInfo.width,
        height: imageInfo.height,
        bytes: 4
    };
    
    if (addMode && !oldMask) {
    	oldMask = mask;
    }
    
    let old = oldMask ? oldMask.data : null;
    
    mask = MagicWand.floodFill(image, x, y, currentThreshold, old, true);
    if (mask) mask = MagicWand.gaussBlurOnlyBorder(mask, blurRadius, old);
    
    if (addMode && oldMask) {
    	mask = mask ? concatMasks(mask, oldMask) : oldMask;
    }
    
    drawBorder();
}
function hatchTick() {
    hatchOffset = (hatchOffset + 1) % (hatchLength * 2);
    drawBorder(true);
}
function drawBorder(noBorder) {
    if (!mask) return;
    
    var x,y,i,j,k,
        w = imageInfo.width,
        h = imageInfo.height,
        ctx = imageInfo.context,
        imgData = ctx.createImageData(w, h),
        res = imgData.data;
    
    if (!noBorder) cacheInd = MagicWand.getBorderIndices(mask);
    
    ctx.clearRect(0, 0, w, h);
    
    var len = cacheInd.length;
    for (j = 0; j < len; j++) {
        i = cacheInd[j];
        x = i % w; // calc x by index
        y = (i - x) / w; // calc y by index
        k = (y * w + x) * 4; 
        if ((x + y + hatchOffset) % (hatchLength * 2) < hatchLength) { // detect hatch color 
            res[k + 3] = 255; // black, change only alpha
        } else {
            res[k] = 255; // white
            res[k + 1] = 255;
            res[k + 2] = 255;
            res[k + 3] = 255;
        }
    }

    ctx.putImageData(imgData, 0, 0);
}
function trace() {
    var cs = MagicWand.traceContours(mask);
    cs = MagicWand.simplifyContours(cs, simplifyTolerant, simplifyCount);

    mask = null;

    // draw contours
    var ctx = imageInfo.context;
    ctx.clearRect(0, 0, imageInfo.width, imageInfo.height);
    //inner
    ctx.beginPath();
    for (var i = 0; i < cs.length; i++) {
        if (!cs[i].inner) continue;
        var ps = cs[i].points;
        ctx.moveTo(ps[0].x, ps[0].y);
        for (var j = 1; j < ps.length; j++) {
            ctx.lineTo(ps[j].x, ps[j].y);
        }
    }
    ctx.strokeStyle = "red";
    ctx.stroke();    
    //outer
    ctx.beginPath();
    for (var i = 0; i < cs.length; i++) {
        if (cs[i].inner) continue;
        var ps = cs[i].points;
        ctx.moveTo(ps[0].x, ps[0].y);
        for (var j = 1; j < ps.length; j++) {
            ctx.lineTo(ps[j].x, ps[j].y);
        }
    }
    ctx.strokeStyle = "blue";
    ctx.stroke();    
}
function paint(color, alpha) {
    if (!mask) return;
    
    var rgba = hexToRgb(color, alpha);
    
    var x,y,
    		data = mask.data,
    		bounds = mask.bounds,
        maskW = mask.width,
        w = imageInfo.width,
        h = imageInfo.height,
        ctx = imageInfo.context,
        imgData = ctx.createImageData(w, h),
        res = imgData.data;
    
    for (y = bounds.minY; y <= bounds.maxY; y++) {
      for (x = bounds.minX; x <= bounds.maxX; x++) {
      		if (data[y * maskW + x] == 0) continue;
          k = (y * w + x) * 4; 
          res[k] = rgba[0];
          res[k + 1] = rgba[1];
          res[k + 2] = rgba[2];
	        res[k + 3] = rgba[3];
      }
		}
    
    mask = null;
    
    ctx.putImageData(imgData, 0, 0);
}
function hexToRgb(hex, alpha) {
  var int = parseInt(hex, 16);
  var r = (int >> 16) & 255;
  var g = (int >> 8) & 255;
  var b = int & 255;

  return [r,g,b, Math.round(alpha * 255)];
}
function concatMasks(mask, old) {
	let 
  	data1 = old.data,
		data2 = mask.data,
		w1 = old.width,
		w2 = mask.width,
		b1 = old.bounds,
		b2 = mask.bounds,
		b = { // bounds for new mask
			minX: Math.min(b1.minX, b2.minX),
			minY: Math.min(b1.minY, b2.minY),
			maxX: Math.max(b1.maxX, b2.maxX),
			maxY: Math.max(b1.maxY, b2.maxY)
		},
		w = old.width, // size for new mask
		h = old.height,
		i, j, k, k1, k2, len;

	let result = new Uint8Array(w * h);

	// copy all old mask
	len = b1.maxX - b1.minX + 1;
	i = b1.minY * w + b1.minX;
	k1 = b1.minY * w1 + b1.minX;
	k2 = b1.maxY * w1 + b1.minX + 1;
	// walk through rows (Y)
	for (k = k1; k < k2; k += w1) {
		result.set(data1.subarray(k, k + len), i); // copy row
		i += w;
	}

	// copy new mask (only "black" pixels)
	len = b2.maxX - b2.minX + 1;
	i = b2.minY * w + b2.minX;
	k1 = b2.minY * w2 + b2.minX;
	k2 = b2.maxY * w2 + b2.minX + 1;
	// walk through rows (Y)
	for (k = k1; k < k2; k += w2) {
		// walk through cols (X)
		for (j = 0; j < len; j++) {
			if (data2[k + j] === 1) result[i + j] = 1;
		}
		i += w;
	}

	return {
		data: result,
		width: w,
		height: h,
		bounds: b
	};
}





    </script>
</body>

</html>